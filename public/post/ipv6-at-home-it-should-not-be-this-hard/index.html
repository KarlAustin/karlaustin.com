<!doctype html><html lang=en><head><meta charset=utf-8><title>IPv6 at Home - It Should Not Be This Hard - Me & Life</title><meta name=description content="IPv6 is 21 years old this year, it shouldn't be this hard to set it up at home."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=twitter:card content="summary_large_image"><meta property="og:site_name" content="Me & Life"><meta property="og:title" content="IPv6 at Home - It Should Not Be This Hard"><meta property="og:description" content="IPv6 is 21 years old this year, it shouldn't be this hard to set it up at home."><meta property="og:type" content="article"><meta property="og:url" content="https://karlaustin.com/post/ipv6-at-home-it-should-not-be-this-hard/"><meta property="og:image" content="https://karlaustin.com/img/main/logo-150.jpg"><link rel="shortcut icon" href=/favicon.ico><meta name=generator content="Hugo 0.110.0"><link rel=stylesheet href=/css/bundle.min.5233f2a4cd515395301b4154f6c1c621695e8cf53faa0935b76ac52fed7f4585.css integrity="sha256-UjPypM1RU5UwG0FU9sHGIWlejPU/qgk1t2rFL+1/RYU="><link rel=stylesheet href=/css/add-on.css></head><body><header id=site-header><nav id=site-nav><h1 class=nav-title><a href=/ class=nav></a></h1><menu id=site-nav-menu class="flyout-menu menu"><a href=/post class="nav link">Blog</a>
<a href=/categories class="nav link">Categories</a>
<a href=/about class="nav link">About</a></menu>
<a href=#site-nav class="nav nav-toggle"><i class="fas fa-bars fa-2x"></i></a></nav></header><div id=wrapper><section id=site-intro><a href=/><img src=/img/main/logo-150.jpg width=100 alt="Me: Karl Austin"></a><header><h1>Me & Life</h1></header><main><p>Family, projects, passions and life in general</p></main></section><main id=site-main><article><div class=post><header><div class=title><h2><a href=/post/ipv6-at-home-it-should-not-be-this-hard/>IPv6 at Home - It Should Not Be This Hard</a></h2><p>IPv6 is 21 years old this year, it shouldn't be this hard to set it up at home.</p></div><div class=meta><time datetime="2017-03-05 09:50:46 +0000 UTC">March 5, 2017</time><p>5-Minute Read</p></div></header><div id=socnet-share></div><div class=content><h1 id=5ghz-here-we-come>5Ghz Here We Come</h1><p>A few months ago I changed my home router from a <a href="https://www.amazon.co.uk/gp/product/B00I4QFQDI/ref=as_li_tl?ie=UTF8&camp=1634&creative=6738&creativeASIN=B00I4QFQDI&linkCode=as2&tag=karlaustincom-21">Mikrotik RB2011</a> router to a <a href="https://www.amazon.co.uk/gp/product/B01562PSIU/ref=as_li_tl?ie=UTF8&camp=1634&creative=6738&creativeASIN=B01562PSIU&linkCode=as2&tag=karlaustincom-21">Linksys WRT1900ACSv2</a> - Not a particularly cheap router, it&rsquo;s still £ even now. I changed because I wanted 5Ghz wireless as the 2.4Ghz around here is massively congested, plus I wanted some faster speeds for copying photos to my NAS. I&rsquo;ve got Gigabit wired to most rooms, but I just can&rsquo;t be bothered to find a cable most of the time to hook up to - I don&rsquo;t usually have one long enough at home, work tends to stay at work these days.</p><h1 id=how-hard-can-it-be-to-get-ipv6-working>How Hard Can It Be To Get IPv6 Working?</h1><p>I didn&rsquo;t really like the Linksys interface, so I did what any self respecting IT geek does, I put DD-WRT firmware on it straight away, which it turns out was a mistake. It has very poor support for IPv6 out of the box, as in virtually non-existent if you just want to put a few details in to the interface and have it work.</p><p>After a couple of hours of googling and faffing I&rsquo;d had enough and went back to the stock Linksys firmware to see what the IPv6 support in that was like, after all it does claim to support IPv6.</p><h1 id=liar-liar-pants-on-fire>Liar Liar, Pants On Fire</h1><p>Whilst it&rsquo;s true that the WRT1900ACSv2 does support IPv6, it&rsquo;s a bodge. The only thing it supports is 6rd, which is tunneling mechanism and not native IPv6. Tunneling is a bodge at the end of the day and high end routers shouldn&rsquo;t just be limiting you to a bodge, they should have proper native IPv6 dual-stack support. There&rsquo;s no excuse these days. None.</p><h1 id=openwrt-come-on-down>OpenWRT, Come On Down</h1><p>After a few minutes ranting at Linksys I switched over to OpenWRT, what a revelation compared to DD-WRT. The web interface, Luci, was virtually instant with anything asked of it and had proper IPv6 support built right in there; that&rsquo;s not to say I didn&rsquo;t have problems though.</p><p>I&rsquo;m on an FTTC connection from <a href=http://goscomb.net>Goscomb</a> and for v6 I have a /48 subnet assigned to me - unfortunately this doesn&rsquo;t get pushed to the router by Router Advertisement (RA) or DHCPv6, only the /64 linknet. Getting the /48 on to the router wasn&rsquo;t an issue, a quick bit of googling gave me the simple and Ubuntu style config file format for the network, within 10 minutes of flashing the router I&rsquo;d got IPv6 addresses out to the clients. That&rsquo;s when the fun began.</p><h1 id=no-ipv6-connectivity>No IPv6 Connectivity</h1><p>Once the clients had got an IPv6 address, they couldn&rsquo;t actually get to anything out on the net. That&rsquo;s when a couple of hours of fiddling around started, I could either:</p><ul><li>Have IPv6 addresses on the clients</li></ul><p>or</p><ul><li>Have the router connect out via IPv6</li></ul><p>but not both. After a while I did get both happening, but still no IPv6 from clients to the net.</p><h1 id=the-solution>The Solution</h1><p>It turns out the default route that was being configured to send IPv6 from the router, to the other end (Goscomb) of the Link-Local v6 subnet wasn&rsquo;t actually doing it&rsquo;s job and I had to manually configure an IPv6 default route to just aim all v6 traffic at the wan interface. A very simple thing to do, but one that still took too long to find and work out late at night.</p><h1 id=my-config-redacted>My Config (Redacted)</h1><p>/etc/config/network</p><pre tabindex=0><code>config interface &#39;loopback&#39;
        option ifname &#39;lo&#39;
        option proto &#39;static&#39;
        option ipaddr &#39;127.0.0.1&#39;
        option netmask &#39;255.0.0.0&#39;

config interface &#39;lan&#39;
        option ifname &#39;eth1&#39;
        option force_link &#39;1&#39;
        option type &#39;bridge&#39;
        option proto &#39;static&#39;
        option ipaddr &#39;192.168.X.1&#39;
        option netmask &#39;255.255.255.0&#39;
        option ip6assign &#39;60&#39;
        option ip6hint &#39;1&#39;

config interface &#39;wan&#39;
        option ifname &#39;eth0&#39;
        option _orig_ifname &#39;eth0&#39;
        option _orig_bridge &#39;false&#39;
        option proto &#39;pppoe&#39;
        option username &#39;user@example.org&#39;
        option password &#39;APasswordHere&#39;

config interface &#39;wan6&#39;
        option ifname &#39;@wan&#39;
        option proto &#39;dhcpv6&#39;
        option reqaddress &#39;try&#39;
        option reqprefix &#39;no&#39;
        option defaultroute &#39;0&#39;
        option ip6prefix &#39;2a01:X:Y::/48&#39;

config &#39;route6&#39;
        option interface &#39;wan&#39;
        option target &#39;::/0&#39;
</code></pre><p>/etc/config/dhcp</p><pre tabindex=0><code>config dnsmasq
        option domainneeded &#39;1&#39;
        option boguspriv &#39;1&#39;
        option filterwin2k &#39;0&#39;
        option localise_queries &#39;1&#39;
        option rebind_protection &#39;1&#39;
        option rebind_localhost &#39;1&#39;
        option local &#39;/lan/&#39;
        option domain &#39;lan&#39;
        option expandhosts &#39;1&#39;
        option nonegcache &#39;0&#39;
        option authoritative &#39;1&#39;
        option readethers &#39;1&#39;
        option leasefile &#39;/tmp/dhcp.leases&#39;
        option resolvfile &#39;/tmp/resolv.conf.auto&#39;
        option localservice &#39;1&#39;

config dhcp &#39;lan&#39;
        option interface &#39;lan&#39;
        option start &#39;100&#39;
        option limit &#39;150&#39;
        option leasetime &#39;48h&#39;
        option ra_maxinterval &#39;30&#39;
        option ra &#39;server&#39;
        option dhcpv6 &#39;server&#39;
        option ra_default &#39;1&#39;
        option ra_management &#39;1&#39;

config dhcp &#39;wan&#39;
        option interface &#39;wan&#39;
        option ignore &#39;1&#39;

config odhcpd &#39;odhcpd&#39;
        option maindhcp &#39;1&#39;
        option leasefile &#39;/tmp/hosts/odhcpd&#39;
        option leasetrigger &#39;/usr/sbin/odhcpd-update&#39;
</code></pre><h1 id=this-is-my-day-job---it-shouldnt-be-this-hard>This Is My Day Job - It Shouldn&rsquo;t Be This Hard!</h1><p>Bearing in mind this is my day job and I work with routers that are insanely complex compared to your average home router and cost well in to 5 figures at the low end, it just shouldn&rsquo;t be this difficult. I get that most people use a router from their ISP so that all of this is hidden from them, bt there are still an awful lot of people who don&rsquo;t because their ISP doesn&rsquo;t provide one, or the one it does provide is awful.</p><p>It&rsquo;s 2017, IPv6 was drafted in 1996, it&rsquo;s 21 years old. In that time it&rsquo;s been tweaked a bit along the way, but there&rsquo;s really no excuse for any home router to not have it, other than saving a few pence on a bill of materials and that&rsquo;s just irresponsible to their users and the internet as a whole. Without widespread IPv6 adoption for end users we end up with nasty solutions such as CG-NAT, when NAT should have been put out of its misery years ago, not adding more layers of complexity to it.</p></div><footer><div class=stats><ul class=categories><li><a class=article-terms-link href=/categories/internet/>Internet</a></li></ul><ul class=tags><li><a class=article-terms-link href=/tags/internet/>internet</a></li><li><a class=article-terms-link href=/tags/ipv6/>ipv6</a></li><li><a class=article-terms-link href=/tags/networking/>networking</a></li></ul></div></footer></div><div class=post><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//karlaustin.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article><div class=pagination><a href=/post/negotiating-with-a-threenager/ class="button left"><span>Negotiating With A Threenager</span></a>
<a href=/post/peertools-automating-notification-of-potential-peers/ class="button right"><span>Peertools: Automated notification of unsolicited BGP Open requests at peering points</span></a></div></main><section id=site-sidebar><section id=recent-posts><header><h1>Recent Posts</h1></header><article class=mini-post><header><h2><a href=/post/editing-markdown-on-the-go/>Editing markdown on the go</a></h2><time class=published datetime="2023-03-01 00:00:00 +0000 UTC">March 1, 2023</time></header></article><article class=mini-post><header><h2><a href=/post/github-actions-and-workflows/>Github Actions and Workflows</a></h2><time class=published datetime="2023-02-28 00:00:00 +0000 UTC">February 28, 2023</time></header></article><article class=mini-post><header><h2><a href=/post/hello-again/>Hello again</a></h2><time class=published datetime="2023-02-28 00:00:00 +0000 UTC">February 28, 2023</time></header></article><article class=mini-post><header><h2><a href=/post/juniper-vmx-centos-i40e-issues/>Juniper vMX CentOS i40e Driver Issues</a></h2><time class=published datetime="2018-01-19 00:00:00 +0000 UTC">January 19, 2018</time></header></article><article class=mini-post><header><h2><a href=/post/negotiating-with-a-threenager/>Negotiating With A Threenager</a></h2><time class=published datetime="2017-03-11 19:55:20 +0000 UTC">March 11, 2017</time></header></article><footer><a href=/blog class=button>See More</a></footer></section><section id=categories><header><h1><a href=/categories>Categories</a></h1></header><ul><li><a href=/categories/internet/>internet<span class=count>5</span></a><li><a href=/categories/photography/>photography<span class=count>2</span></a><li><a href=/categories/websites/>websites<span class=count>2</span></a><li><a href=/categories/blogging/>blogging<span class=count>1</span></a><li><a href=/categories/business/>business<span class=count>1</span></a><li><a href=/categories/development/>development<span class=count>1</span></a><li><a href=/categories/general/>general<span class=count>1</span></a><li><a href=/categories/life/>life<span class=count>1</span></a></li></ul></section><section id=mini-bio><header><h1>About</h1></header><p>This theme was developed for Hugo static site generator.</p><footer><a href=/about class=button>Learn More</a></footer></section></section><footer id=site-footer><p class=copyright>© 2023 Me & Life<br>Theme: <a href=https://github.com/pacollins/hugo-future-imperfect-slim target=_blank rel=noopener>Hugo Future Imperfect Slim</a><br>A <a href=https://html5up.net/future-imperfect target=_blank rel=noopener>HTML5 UP port</a> | Powered by <a href=https://gohugo.io/ title=0.110.0 target=_blank rel=noopener>Hugo</a></p></footer><a id=back-to-top href=# class="fas fa-arrow-up fa-2x"></a>
<script src=/js/highlight.js></script>
<script>hljs.highlightAll()</script><script src=/js/bundle.min.264c62b2d798d1c6d28933f76015f64ca5ade337b93d27412420b18bce46b20e.js integrity="sha256-JkxisteY0cbSiTP3YBX2TKWt4ze5PSdBJCCxi85Gsg4="></script>
<script src=/js/add-on.js></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-75661737-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></div></body></html>