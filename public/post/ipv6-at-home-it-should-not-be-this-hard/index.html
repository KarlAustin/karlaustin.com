<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-gb lang=en-gb><head><script defer language=javascript type=text/javascript src=https://karlaustin.com/js/light_dark.js></script>
<script defer language=javascript type=text/javascript src=https://karlaustin.com/js/tabs.js></script>
<script defer language=javascript type=text/javascript src=https://karlaustin.com/js/katex.min.js></script>
<script defer language=javascript type=text/javascript src=https://karlaustin.com/js/auto-render.min.js></script>
<script defer language=javascript type=text/javascript src=https://karlaustin.com/js/katex.js></script>
<script defer language=javascript type=text/javascript src=https://karlaustin.com/js/toc.js></script><meta charset=utf-8><meta name=generator content="Hugo 0.110.0"><meta name=viewport content="width=device-width,initial-scale=1"><title>IPv6 at Home - It Should Not Be This Hard &#183; Me & Life</title><meta name=description content="IPv6 is 21 years old this year, it shouldn't be this hard to set it up at home."><link type=text/css rel=stylesheet href=https://karlaustin.com/css/poole.css><link type=text/css rel=stylesheet href=https://karlaustin.com/css/syntax.css><link type=text/css rel=stylesheet href=https://karlaustin.com/css/hyde.css><link type=text/css rel=stylesheet href=https://karlaustin.com/css/poison.css><link type=text/css rel=stylesheet href=https://karlaustin.com/css/fonts.css><link type=text/css rel=stylesheet href=https://karlaustin.com/css/katex.min.css><link type=text/css rel=stylesheet href=https://karlaustin.com/css/tabs.css><style>body{--sidebar-bg-color:#202020;--sidebar-img-border-color:#515151;--sidebar-p-color:#909090;--sidebar-h1-color:#FFF;--sidebar-a-color:#FFF;--sidebar-socials-color:#FFF;--text-color:#222;--bkg-color:#FAF9F6;--post-title-color:#303030;--list-color:#5a5a5a;--link-color:#268bd2;--date-color:#515151;--table-border-color:#E5E5E5;--table-stripe-color:#F9F9F9;--code-color:#bf616a;--code-background-color:#E5E5E5;--moon-sun-color:#FFF;--moon-sun-background-color:#515151}body.dark-theme{--text-color:#eee;--bkg-color:#121212;--post-title-color:#DBE2E9;--list-color:#9d9d9d;--link-color:#268bd2;--date-color:#9a9a9a;--table-border-color:#515151;--table-stripe-color:#202020;--code-color:#ff7f7f;--code-background-color:#393D47}body{background-color:var(--bkg-color)}</style></head><body class=dark-theme><aside class=sidebar><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark><svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class=sidebar-about><h1 class=brand><a href=https://karlaustin.com/><img src=/img/main/logo-150.jpg alt="brand image"></a>
<a href=https://karlaustin.com/><h1>Karl Austin</h1></a></h1><p class=lead></p></div><nav><ul class=sidebar-nav><li class=heading><a href=/post/>Posts</a></li><li class=sub-heading>Recent</li><li class=bullet><a href=https://karlaustin.com/post/editing-markdown-on-the-go/>Editing markdown on the go</a></li><li class=bullet><a href=https://karlaustin.com/post/github-actions-and-workflows/>Github Actions and Workflows</a></li><li class=bullet><a href=https://karlaustin.com/post/hello-again/>Hello again</a></li><li class=bullet><a href=https://karlaustin.com/post/juniper-vmx-centos-i40e-issues/>Juniper vMX CentOS i40e Driver Issues</a></li><li class=bullet><a href=https://karlaustin.com/post/negotiating-with-a-threenager/>Negotiating With A Threenager</a></li></ul></nav><a target=_blank class=social href=https://github.com/KarlAustin><svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24"><path fill="currentcolor" d="M18.88 1.099C18.147.366 17.265.0 16.233.0H3.746C2.714.0 1.832.366 1.099 1.099.366 1.832.0 2.714.0 3.746v12.487c0 1.032.366 1.914 1.099 2.647.733.733 1.615 1.099 2.647 1.099H6.66c.19.0.333-.007.429-.02a.504.504.0 00.286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555.0 01-.904-.091 2.026 2.026.0 01-.872-.39 1.651 1.651.0 01-.572-.8l-.13-.3a3.25 3.25.0 00-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956.0 01-.17-.156.723.723.0 01-.117-.182c-.026-.061-.004-.111.065-.15.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1.0 01.631.677c.2.355.44.626.722.813.282.186.566.28.852.28.286.0.533-.022.742-.065a2.59 2.59.0 00.585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907.0 01-1.333-.234 5.314 5.314.0 01-1.223-.507 3.5 3.5.0 01-1.047-.872c-.277-.347-.505-.802-.683-1.365-.177-.564-.266-1.215-.266-1.952.0-1.049.342-1.942 1.027-2.68-.32-.788-.29-1.673.091-2.652.252-.079.625-.02 1.119.175.494.195.856.362 1.086.5.23.14.414.257.553.352a9.233 9.233.0 012.497-.338c.859.0 1.691.113 2.498.338l.494-.312a6.997 6.997.0 011.197-.572c.46-.174.81-.221 1.054-.143.39.98.424 1.864.103 2.653.685.737 1.028 1.63 1.028 2.68.0.737-.089 1.39-.267 1.957-.177.568-.407 1.023-.689 1.366a3.65 3.65.0 01-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9.0 01-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36.0 00.208.189c.096.034.18.056.254.064.074.01.18.013.318.013h2.914c1.032.0 1.914-.366 2.647-1.099.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/></svg></a><a target=_blank class=social href=https://www.linkedin.com/in/karlaustinuk/><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></a><a target=_blank class=social href=https://twitter.com/KarlAustin><svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 16 16"><path fill="currentcolor" d="M5.032 14.286c6.037.0 9.34-4.837 9.34-9.032.0-.137.0-.274-.01-.41A6.56 6.56.0 0016 3.2c-.6.256-1.235.425-1.885.5a3.207 3.207.0 001.443-1.757c-.645.37-1.35.63-2.085.77a3.322 3.322.0 00-1.862-.958 3.384 3.384.0 00-2.082.334 3.223 3.223.0 00-1.442 1.49 3.08 3.08.0 00-.208 2.03 9.57 9.57.0 01-3.747-.963A9.269 9.269.0 011.114 2.292a3.086 3.086.0 00-.36 2.314c.189.787.68 1.475 1.376 1.924A3.344 3.344.0 01.64 6.132v.04c0 .734.263 1.444.743 2.01a3.3 3.3.0 001.89 1.102c-.483.128-.99.146-1.482.055a3.19 3.19.0 001.168 1.577 3.36 3.36.0 001.9.627A6.732 6.732.0 010 12.86a9.527 9.527.0 005.032 1.423"/></svg></a><a target=_blank class=social href=https://discord.com><svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24"><path fill="currentcolor" d="M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09.0 00-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09.0 00-4.8.0c-.14-.34-.35-.76-.54-1.09-.01-.02-.04-.03-.07-.03-1.5.26-2.93.71-4.27 1.33-.01.0-.02.01-.03.02-2.72 4.07-3.47 8.03-3.1 11.95.0.02.01.04.03.05 1.8 1.32 3.53 2.12 5.24 2.65.03.01.06.0.07-.02.4-.55.76-1.13 1.07-1.74.02-.04.0-.08-.04-.09-.57-.22-1.11-.48-1.64-.78-.04-.02-.04-.08-.01-.11.11-.08.22-.17.33-.25.02-.02.05-.02.07-.01 3.44 1.57 7.15 1.57 10.55.0.02-.01.05-.01.07.01.11.09.22.17.33.26.04.03.04.09-.01.11-.52.31-1.07.56-1.64.78-.04.01-.05.06-.04.09.32.61.68 1.19 1.07 1.74.03.01.06.02.09.01 1.72-.53 3.45-1.33 5.25-2.65.02-.01.03-.03.03-.05.44-4.53-.73-8.46-3.1-11.95-.01-.01-.02-.02-.04-.02zM8.52 14.91c-1.03.0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06.0 1.9.96 1.89 2.12.0 1.17-.84 2.12-1.89 2.12zm6.97.0c-1.03.0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06.0 1.9.96 1.89 2.12.0 1.17-.83 2.12-1.89 2.12z"/></svg></a><a target=_blank class=social href=https://www.instagram.com/ilumiaimages/><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512"><path fill="currentcolor" d="M224.1 141c-63.6.0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1.0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9.0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9.0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9.0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9.0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8.0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg></a><a target=_blank class=social href=https://facebook.com/karlpaustin><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512"><path fill="currentcolor" d="M4e2 32H48A48 48 0 000 80v352a48 48 0 0048 48h137.25V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.27c-30.81.0-40.42 19.12-40.42 38.73V256h68.78l-11 71.69h-57.78V480H4e2a48 48 0 0048-48V80a48 48 0 00-48-48z"/></svg></a><p class=footnote>powered by <a target=_blank href=https://gohugo.io>Hugo</a> | themed with <a target=_blank href=https://github.com/lukeorth/poison>poison</a><br>&copy; 2023 Me & Life. All rights reserved.</p></div></aside><main class="content container"><div class=post><div class=info><h1 class=post-title><a href=https://karlaustin.com/post/ipv6-at-home-it-should-not-be-this-hard/>IPv6 at Home - It Should Not Be This Hard</a></h1><time datetime=2017-03-05T09:50:46Z class=post-date>March 5, 2017</time><ul class=tags><li class=tag-internet><a href=https://karlaustin.com/tags/internet>internet</a></li><li class=tag-ipv6><a href=https://karlaustin.com/tags/ipv6>ipv6</a></li><li class=tag-networking><a href=https://karlaustin.com/tags/networking>networking</a></li></ul></div><h2 id=5ghz-here-we-come>5Ghz Here We Come</h2><p>A few months ago I changed my home router from a <a href="https://www.amazon.co.uk/gp/product/B00I4QFQDI/ref=as_li_tl?ie=UTF8&camp=1634&creative=6738&creativeASIN=B00I4QFQDI&linkCode=as2&tag=karlaustincom-21">Mikrotik RB2011</a> router to a <a href="https://www.amazon.co.uk/gp/product/B01562PSIU/ref=as_li_tl?ie=UTF8&camp=1634&creative=6738&creativeASIN=B01562PSIU&linkCode=as2&tag=karlaustincom-21">Linksys WRT1900ACSv2</a> - Not a particularly cheap router, it&rsquo;s still £ even now. I changed because I wanted 5Ghz wireless as the 2.4Ghz around here is massively congested, plus I wanted some faster speeds for copying photos to my NAS. I&rsquo;ve got Gigabit wired to most rooms, but I just can&rsquo;t be bothered to find a cable most of the time to hook up to - I don&rsquo;t usually have one long enough at home, work tends to stay at work these days.</p><h2 id=how-hard-can-it-be-to-get-ipv6-working>How Hard Can It Be To Get IPv6 Working?</h2><p>I didn&rsquo;t really like the Linksys interface, so I did what any self respecting IT geek does, I put DD-WRT firmware on it straight away, which it turns out was a mistake. It has very poor support for IPv6 out of the box, as in virtually non-existent if you just want to put a few details in to the interface and have it work.</p><p>After a couple of hours of googling and faffing I&rsquo;d had enough and went back to the stock Linksys firmware to see what the IPv6 support in that was like, after all it does claim to support IPv6.</p><h2 id=liar-liar-pants-on-fire>Liar Liar, Pants On Fire</h2><p>Whilst it&rsquo;s true that the WRT1900ACSv2 does support IPv6, it&rsquo;s a bodge. The only thing it supports is 6rd, which is tunneling mechanism and not native IPv6. Tunneling is a bodge at the end of the day and high end routers shouldn&rsquo;t just be limiting you to a bodge, they should have proper native IPv6 dual-stack support. There&rsquo;s no excuse these days. None.</p><h2 id=openwrt-come-on-down>OpenWRT, Come On Down</h2><p>After a few minutes ranting at Linksys I switched over to OpenWRT, what a revelation compared to DD-WRT. The web interface, Luci, was virtually instant with anything asked of it and had proper IPv6 support built right in there; that&rsquo;s not to say I didn&rsquo;t have problems though.</p><p>I&rsquo;m on an FTTC connection from <a href=http://goscomb.net>Goscomb</a> and for v6 I have a /48 subnet assigned to me - unfortunately this doesn&rsquo;t get pushed to the router by Router Advertisement (RA) or DHCPv6, only the /64 linknet. Getting the /48 on to the router wasn&rsquo;t an issue, a quick bit of googling gave me the simple and Ubuntu style config file format for the network, within 10 minutes of flashing the router I&rsquo;d got IPv6 addresses out to the clients. That&rsquo;s when the fun began.</p><h2 id=no-ipv6-connectivity>No IPv6 Connectivity</h2><p>Once the clients had got an IPv6 address, they couldn&rsquo;t actually get to anything out on the net. That&rsquo;s when a couple of hours of fiddling around started, I could either:</p><ul><li>Have IPv6 addresses on the clients</li></ul><p>or</p><ul><li>Have the router connect out via IPv6</li></ul><p>but not both. After a while I did get both happening, but still no IPv6 from clients to the net.</p><h2 id=the-solution>The Solution</h2><p>It turns out the default route that was being configured to send IPv6 from the router, to the other end (Goscomb) of the Link-Local v6 subnet wasn&rsquo;t actually doing it&rsquo;s job and I had to manually configure an IPv6 default route to just aim all v6 traffic at the wan interface. A very simple thing to do, but one that still took too long to find and work out late at night.</p><h2 id=my-config-redacted>My Config (Redacted)</h2><p>/etc/config/network</p><pre tabindex=0><code>config interface &#39;loopback&#39;
        option ifname &#39;lo&#39;
        option proto &#39;static&#39;
        option ipaddr &#39;127.0.0.1&#39;
        option netmask &#39;255.0.0.0&#39;

config interface &#39;lan&#39;
        option ifname &#39;eth1&#39;
        option force_link &#39;1&#39;
        option type &#39;bridge&#39;
        option proto &#39;static&#39;
        option ipaddr &#39;192.168.X.1&#39;
        option netmask &#39;255.255.255.0&#39;
        option ip6assign &#39;60&#39;
        option ip6hint &#39;1&#39;

config interface &#39;wan&#39;
        option ifname &#39;eth0&#39;
        option _orig_ifname &#39;eth0&#39;
        option _orig_bridge &#39;false&#39;
        option proto &#39;pppoe&#39;
        option username &#39;user@example.org&#39;
        option password &#39;APasswordHere&#39;

config interface &#39;wan6&#39;
        option ifname &#39;@wan&#39;
        option proto &#39;dhcpv6&#39;
        option reqaddress &#39;try&#39;
        option reqprefix &#39;no&#39;
        option defaultroute &#39;0&#39;
        option ip6prefix &#39;2a01:X:Y::/48&#39;

config &#39;route6&#39;
        option interface &#39;wan&#39;
        option target &#39;::/0&#39;
</code></pre><p>/etc/config/dhcp</p><pre tabindex=0><code>config dnsmasq
        option domainneeded &#39;1&#39;
        option boguspriv &#39;1&#39;
        option filterwin2k &#39;0&#39;
        option localise_queries &#39;1&#39;
        option rebind_protection &#39;1&#39;
        option rebind_localhost &#39;1&#39;
        option local &#39;/lan/&#39;
        option domain &#39;lan&#39;
        option expandhosts &#39;1&#39;
        option nonegcache &#39;0&#39;
        option authoritative &#39;1&#39;
        option readethers &#39;1&#39;
        option leasefile &#39;/tmp/dhcp.leases&#39;
        option resolvfile &#39;/tmp/resolv.conf.auto&#39;
        option localservice &#39;1&#39;

config dhcp &#39;lan&#39;
        option interface &#39;lan&#39;
        option start &#39;100&#39;
        option limit &#39;150&#39;
        option leasetime &#39;48h&#39;
        option ra_maxinterval &#39;30&#39;
        option ra &#39;server&#39;
        option dhcpv6 &#39;server&#39;
        option ra_default &#39;1&#39;
        option ra_management &#39;1&#39;

config dhcp &#39;wan&#39;
        option interface &#39;wan&#39;
        option ignore &#39;1&#39;

config odhcpd &#39;odhcpd&#39;
        option maindhcp &#39;1&#39;
        option leasefile &#39;/tmp/hosts/odhcpd&#39;
        option leasetrigger &#39;/usr/sbin/odhcpd-update&#39;
</code></pre><h2 id=this-is-my-day-job---it-shouldnt-be-this-hard>This Is My Day Job - It Shouldn&rsquo;t Be This Hard!</h2><p>Bearing in mind this is my day job and I work with routers that are insanely complex compared to your average home router and cost well in to 5 figures at the low end, it just shouldn&rsquo;t be this difficult. I get that most people use a router from their ISP so that all of this is hidden from them, bt there are still an awful lot of people who don&rsquo;t because their ISP doesn&rsquo;t provide one, or the one it does provide is awful.</p><p>It&rsquo;s 2017, IPv6 was drafted in 1996, it&rsquo;s 21 years old. In that time it&rsquo;s been tweaked a bit along the way, but there&rsquo;s really no excuse for any home router to not have it, other than saving a few pence on a bill of materials and that&rsquo;s just irresponsible to their users and the internet as a whole. Without widespread IPv6 adoption for end users we end up with nasty solutions such as CG-NAT, when NAT should have been put out of its misery years ago, not adding more layers of complexity to it.</p><hr><div class=footer></div><div class=article-toc><h4></h4><nav id=TableOfContents><ul><li><a href=#5ghz-here-we-come>5Ghz Here We Come</a></li><li><a href=#how-hard-can-it-be-to-get-ipv6-working>How Hard Can It Be To Get IPv6 Working?</a></li><li><a href=#liar-liar-pants-on-fire>Liar Liar, Pants On Fire</a></li><li><a href=#openwrt-come-on-down>OpenWRT, Come On Down</a></li><li><a href=#no-ipv6-connectivity>No IPv6 Connectivity</a></li><li><a href=#the-solution>The Solution</a></li><li><a href=#my-config-redacted>My Config (Redacted)</a></li><li><a href=#this-is-my-day-job---it-shouldnt-be-this-hard>This Is My Day Job - It Shouldn&rsquo;t Be This Hard!</a></li></ul></nav></div></div></main></body></html>